<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263Px MCU+ SDK: ADC Open Shorts Detection</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263Px MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263Px MCU+ SDK
   &#160;<span id="projectnumber">11.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_DRIVERS_ADC_OPEN_SHORTS_DETECTION.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ADC Open Shorts Detection </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1984">Example Description</a><ul><li class="level2"><a href="#autotoc_md1985">Assumptions for the OSD Usage</a></li>
<li class="level2"><a href="#autotoc_md1986">OSD Circuit configurations</a></li>
<li class="level2"><a href="#autotoc_md1987">Qualification process</a></li>
<li class="level2"><a href="#autotoc_md1988">Configurations</a></li>
<li class="level2"><a href="#autotoc_md1989">External Connections</a></li>
<li class="level2"><a href="#autotoc_md1990">Watch Variables</a></li>
</ul>
</li>
<li class="level1"><a href="#EXAMPLES_DRIVERS_ADC_OPEN_SHORTS_DETECTION_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md1991">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md1992">See Also</a></li>
<li class="level1"><a href="#autotoc_md1993">Sample Output</a><ul><li class="level2"><a href="#autotoc_md1994">An Open Pin sample result</a></li>
<li class="level2"><a href="#autotoc_md1995">A Pin Shorted to VREFLO sample result</a></li>
<li class="level2"><a href="#autotoc_md1996">A Pin Shorted to VREFHI sample result</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_adc_open_shorts_detection"></a></p>
<h1><a class="anchor" id="autotoc_md1984"></a>
Example Description</h1>
<p>This example demonstrates the Open Shorts Detection circuit on the ADC channels for detecting the pin faults in the system. the example enables the OSD circuit along with the mandatory ADC configurations (see Assumptions below) and diagnoses ADC0-Channel 0 input pin. The open short detection circuit connects a resistor between an analog input pad and either supply or ground. These resistors can be used to estimate the input impedance of the circuit driving the analog input pad thereby detecting if the pad is shorted or open.</p>
<h2><a class="anchor" id="autotoc_md1985"></a>
Assumptions for the OSD Usage</h2>
<ol type="1">
<li>ADC is in Single Ended Mode</li>
<li>Sampling time is increased well above the minimum value</li>
<li>Atleast 1 uS delay after configuring the OSD circuit to ADC samples</li>
<li>OSD is not implemented on the CAL 1,2 inputs.</li>
<li>Divider Resistence tolerances vary widely and are not used for accuracy checks</li>
</ol>
<h2><a class="anchor" id="autotoc_md1986"></a>
OSD Circuit configurations</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">config  </th><th class="markdownTableHeadNone">function  </th><th class="markdownTableHeadNone">Impedance  </th><th class="markdownTableHeadNone">Voltage on 5K  </th><th class="markdownTableHeadNone">Voltage on 7K   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0  </td><td class="markdownTableBodyNone">Zero Scale  </td><td class="markdownTableBodyNone">5K // 7K  </td><td class="markdownTableBodyNone">VSSA  </td><td class="markdownTableBodyNone">VSSA   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">Zero Scale  </td><td class="markdownTableBodyNone">5K  </td><td class="markdownTableBodyNone">VSSA  </td><td class="markdownTableBodyNone">OPEN   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone">Zero Scale  </td><td class="markdownTableBodyNone">7K  </td><td class="markdownTableBodyNone">OPEN  </td><td class="markdownTableBodyNone">VSSA   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone">Full Scale  </td><td class="markdownTableBodyNone">5K // 7K  </td><td class="markdownTableBodyNone">VDD  </td><td class="markdownTableBodyNone">VDD   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone">Full Scale  </td><td class="markdownTableBodyNone">5K  </td><td class="markdownTableBodyNone">VDD  </td><td class="markdownTableBodyNone">OPEN   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">5  </td><td class="markdownTableBodyNone">Full Scale  </td><td class="markdownTableBodyNone">7K  </td><td class="markdownTableBodyNone">OPEN  </td><td class="markdownTableBodyNone">VDD   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">6  </td><td class="markdownTableBodyNone">5/12 Scale  </td><td class="markdownTableBodyNone">5K // 7K  </td><td class="markdownTableBodyNone">VSSA  </td><td class="markdownTableBodyNone">VDD   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">7  </td><td class="markdownTableBodyNone">5/12 Scale  </td><td class="markdownTableBodyNone">5K // 7K  </td><td class="markdownTableBodyNone">VDD  </td><td class="markdownTableBodyNone">VSSA   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1987"></a>
Qualification process</h2>
<p>In the example, ADCA A0 channel is configured and following algorithm is used to check the A0 pin status:</p><ol type="1">
<li>Configure full scale OSDETECT mode &amp; capture ADC results(resultHi)</li>
<li>Configure zero scale OSDETECT mode &amp; capture ADC results(resultLo)</li>
<li>Disable OSDETECT mode and capture ADC results(resultNormal)</li>
<li>Determine the state of the ADC pin<ol type="a">
<li>If the pin is open, resultLo would be equal to Vreflo and resultHi would be equal to Vrefhi</li>
<li>If the pin is shorted to Vrefhi, resultLo should be approximately equal to Vrefhi and resultHi should be equal to Vrefhi</li>
<li>If the pin is shorted to Vreflo, resultLo should be equal to Vreflo and resultHi should be approximately equal to Vreflo</li>
<li>If the pin is connected to a valid signal, resultLo should be greater than osdLoLimit but less than resultNormal while resultHi should be less than osdHiLimit but greater than resultNormal</li>
</ol>
</li>
</ol>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Input  </th><th class="markdownTableHeadNone">Full-Scale output  </th><th class="markdownTableHeadNone">Zero-scale Output  </th><th class="markdownTableHeadNone">Pin Status   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unknown  </td><td class="markdownTableBodyNone">VREFHI  </td><td class="markdownTableBodyNone">VREFLO  </td><td class="markdownTableBodyNone">Open   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">VREFHI  </td><td class="markdownTableBodyNone">VREFHI  </td><td class="markdownTableBodyNone">approx. VREFHI  </td><td class="markdownTableBodyNone">Shorted to VREFHI   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VREFLO  </td><td class="markdownTableBodyNone">approx. VREFLO  </td><td class="markdownTableBodyNone">VREFLO  </td><td class="markdownTableBodyNone">Shorted to VREFLO   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Vn  </td><td class="markdownTableBodyNone">Vn &lt; resultHi &lt; VREFHI  </td><td class="markdownTableBodyNone">VREFLO &lt; resultLo &lt; Vn  </td><td class="markdownTableBodyNone">Good   </td></tr>
</table>
<ol type="1">
<li>osDetectStatusVal of value greater than 4 would mean that there is no pin fault.<ol type="a">
<li>If osDetectStatusVal == 1, means pin A0 is OPEN</li>
<li>If osDetectStatusVal == 2, means pin A0 is shorted to VREFLO</li>
<li>If osDetectStatusVal == 4, means pin A0 is shorted to VREFHI</li>
<li>If osDetectStatusVal == 8, means pin A0 is in GOOD/VALID state</li>
<li>Any value of osDetectStatusVal &gt; 4, means pin A0 is in VALID state</li>
</ol>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md1988"></a>
Configurations</h2>
<ol type="1">
<li>The ADC0 SOC0 is configured sample on the Channel 2.</li>
<li>The SOC0 Sample and hold window is set to 256 for OSD detection usecase</li>
<li>ADC0 INT1 is configured for the EOC0.</li>
<li>SOC0 is triggered by Software.</li>
<li>OSD circuit is enabeld for ADC0, Channel 2 (see below execution) </li>
</ol>
<h2><a class="anchor" id="autotoc_md1989"></a>
External Connections</h2>
<p>ADC0-SOC0 Samples on Channel 2.</p><ul>
<li>on AM263Px CC E2 or AM261x-SOM E1, with HSEC Dock<ul>
<li>Feed Analog input to ADC0_AIN2 - HSEC PIN 15</li>
</ul>
</li>
<li>on AM263Px LP<ul>
<li>Feed Analog Input to the ADC0_AIN2 - J7 Pin 66</li>
</ul>
</li>
<li>on AM261x-LP<ul>
<li>Feed Analog Input to the ADC0_AIN2 - J7 Pin 63</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1990"></a>
Watch Variables</h2>
<p>osDetectStatusVal - OS detection status of voltage on ADC Channel. adcResult - a digital representation of the voltage on ADC Channel. */</p>
<h1><a class="anchor" id="EXAMPLES_DRIVERS_ADC_OPEN_SHORTS_DETECTION_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 nortos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am263px-cc, am263px-lp   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/adc/adc_open_shorts_detection/   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md1991"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>)</li>
<li>Establish connections as mentioned in External Connections section</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
<li>Using watch variables, view the ADC conversion results.</li>
<li>View the ADC conversion results in UART console logs</li>
</ul>
<h1><a class="anchor" id="autotoc_md1992"></a>
See Also</h1>
<p><a class="el" href="DRIVERS_ADC_PAGE.html">ADC</a></p>
<h1><a class="anchor" id="autotoc_md1993"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is run, </p>
<h2><a class="anchor" id="autotoc_md1994"></a>
An Open Pin sample result</h2>
<div class="fragment"><div class="line">ADC Open Shorts Detection Test Started ...</div>
<div class="line">config  |   Result  |   Mean Result |Result without OSD on</div>
<div class="line">0       |   43      |   2056        |4095</div>
<div class="line">1       |   11      |   2056        |4095</div>
<div class="line">2       |   12      |   2056        |4095</div>
<div class="line">3       |   4095    |   2056        |4095</div>
<div class="line">4       |   4095    |   2056        |4095</div>
<div class="line">5       |   4095    |   2056        |4095</div>
<div class="line">status : APP_ADC_OSDETECT_STATUS_OPEN</div>
<div class="line">ADC Open Shorts Detection Test Passed</div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1995"></a>
A Pin Shorted to VREFLO sample result</h2>
<div class="fragment"><div class="line">ADC Open Shorts Detection Test Started ...</div>
<div class="line">config  |   Result  |   Mean Result |Result without OSD on</div>
<div class="line">0       |   0       |   1           |0</div>
<div class="line">1       |   0       |   1           |0</div>
<div class="line">2       |   0       |   1           |0</div>
<div class="line">3       |   6       |   1           |0</div>
<div class="line">4       |   2       |   1           |0</div>
<div class="line">5       |   1       |   1           |0</div>
<div class="line">status : APP_ADC_OSDETECT_STATUS_SHORTED_TO_VREFLO</div>
<div class="line">ADC Open Shorts Detection Test Passed</div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1996"></a>
A Pin Shorted to VREFHI sample result</h2>
<div class="fragment"><div class="line">ADC Open Shorts Detection Test Started ...</div>
<div class="line">config  |   Result  |   Mean Result |Result without OSD on</div>
<div class="line">0       |   4095    |   4092        |4095</div>
<div class="line">1       |   4095    |   4092        |4095</div>
<div class="line">2       |   4095    |   4092        |4095</div>
<div class="line">3       |   4095    |   4092        |4095</div>
<div class="line">4       |   4095    |   4092        |4095</div>
<div class="line">5       |   4095    |   4092        |4095</div>
<div class="line">status : APP_ADC_OSDETECT_STATUS_SHORTED_TO_VREFHI</div>
<div class="line">ADC Open Shorts Detection Test Passed</div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
