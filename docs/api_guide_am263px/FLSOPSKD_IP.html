<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263Px MCU+ SDK: How to use Flash Operation Scheduler Hardware</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263Px MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263Px MCU+ SDK
   &#160;<span id="projectnumber">11.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('FLSOPSKD_IP.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">How to use Flash Operation Scheduler Hardware </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md619">Introduction</a><ul><li class="level2"><a href="#autotoc_md620">Why is FLSOPSKD Hardware Engine?</a></li>
<li class="level2"><a href="#autotoc_md621">What is FLSOPSKD Hardware Engine?</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md622">Example Firmware</a></li>
<li class="level1"><a href="#autotoc_md623">Using FLSOPSKD in Application</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_developer_guides_flsopskd_flsopskd"></a></p>
<h1><a class="anchor" id="autotoc_md619"></a>
Introduction</h1>
<p>This page goes over different aspect of flash operation scheduler (FLSOPSKD) hardware engine.</p>
<h2><a class="anchor" id="autotoc_md620"></a>
Why is FLSOPSKD Hardware Engine?</h2>
<p>OptiFlash technology (<a class="el" href="OPTIFLASH.html">OptiFlash Memory Technology</a>) enables XIP, in case, where an application is performing flash writes, would look like as follows:</p>
<p>The following image shows the same:  <style>div.image img[src="general_flash_access_request_multicore.png"]{width:40%}</style> </p><div class="image">
<img src="general_flash_access_request_multicore.png" alt=""/>
<div class="caption">
General Flash Access Usecase</div></div>
<p>Here each CPU is requestion data from the external flash through <code>flash controller</code> for performing XIP or read from the external flash and sending erase, write or status read request. On top of this, each request is asynchronous in nature, meaning that any request can come at anytime.</p>
<p>External flash is connected to microcontroller over 8 data lines (OSPI) and on same data lines, both reads and writes would happen. And in any flash write scenerio, writes would be happening while XIP is going on. During writing, reading should be stopped which also mean that XIP needs to be stopped and this would have an impact on performance and increased complexity in system design.</p>
<p>To synchronize all the read and write request on same 8bit data bus and to minimize the XIP/Read downtime, FLSOPSKD IP has been added. This will help schedule different flash related transaction by prioritizing XIP/Reads. XIP/Reads are prioritized because writes and erase to a nor flash are anyway very slow (may take multiple seconds for a single operation, depending on flash).</p>
<h2><a class="anchor" id="autotoc_md621"></a>
What is FLSOPSKD Hardware Engine?</h2>
<dl class="section note"><dt>Note</dt><dd>please refer to TRM and datasheet for details of this hardware.</dd></dl>
<p>To achieve this sort of scheduling, with Optiflash, FLSOPSKD Hardware Engine has been added on top of Flash controller.</p>
<p>The following image shows the same:  <style>div.image img[src="flsopskd_internal.png"]{width:40%}</style> </p><div class="image">
<img src="flsopskd_internal.png" alt=""/>
<div class="caption">
Flash Operation Scheduler Hardware</div></div>
<p>One key feature of this hardware is that there is a 8051MCU inside this which is also programable. It has its own program memory (2KB in case of AM263Px) and data memory of 256B.</p>
<p>This 8051 has a very close access to flash controller's configuration and some hooks to know the state of the flash controller (or OSPI controller in case of AM263Px).</p>
<p>R5F CPU or anyother CPU, when it is required to communicate to 8051 would program the MMR registers and signal the firmware that is running inside the 8051 to further process it.</p>
<dl class="section note"><dt>Note</dt><dd>TI provide an 8051 firmware OOB as an example.</dd></dl>
<h1><a class="anchor" id="autotoc_md622"></a>
Example Firmware</h1>
<p>TI Provides some recommendation on how to write custom implementation of the above described scheduling.</p>
<p>The following image shows the same:  <style>div.image img[src="fw_example_implementation.png"]{width:40%}</style> </p><div class="image">
<img src="fw_example_implementation.png" alt=""/>
<div class="caption">
Firmware Example Implementation</div></div>
<p>On the left hand side, any core which is trying to communicate to 8051 fiirmware would follow the and on the right hand side are the steps that 8051 would follow after recieving signal from SOC core.</p>
<p>Based on the above steps, MCU+ SDK drivers come with prebuit firmware of 8051 and its corresponding R5F drivers.</p>
<h1><a class="anchor" id="autotoc_md623"></a>
Using FLSOPSKD in Application</h1>
<p>Please refer to <a class="el" href="DRIVERS_FLSOPSKD_PAGE.html">FLSOPSKD</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
