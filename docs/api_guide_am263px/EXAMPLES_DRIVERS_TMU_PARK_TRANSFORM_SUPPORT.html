<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM263Px MCU+ SDK: TMU PARK TRANSFORM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="AM263Px MCU+ SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM263Px MCU+ SDK
   &#160;<span id="projectnumber">11.02.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_DRIVERS_TMU_PARK_TRANSFORM_SUPPORT.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">TMU PARK TRANSFORM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md2926">Introduction</a><ul><li class="level2"><a href="#autotoc_md2927">Interrupt Configurations</a></li>
<li class="level2"><a href="#autotoc_md2928">ISR</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md2929">External Connections</a><ul><li class="level2"><a href="#autotoc_md2930">AM263PX-CC E2</a></li>
<li class="level2"><a href="#autotoc_md2931">AM263PX-CC E1</a></li>
<li class="level2"><a href="#autotoc_md2932">AM263PX-LP</a></li>
</ul>
</li>
<li class="level1"><a href="#EXAMPLES_DRIVERSTMU_PARK_TRANSFORM_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md2933">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md2934">Sample Output</a></li>
<li class="level1"><a href="#autotoc_md2935">See Also</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_tmu_park_transform"></a></p>
<h1><a class="anchor" id="autotoc_md2926"></a>
Introduction</h1>
<p>This example demonstrates the gains of using TMU in an application-level. The example makes use of Park and Inverse Park Transform application which has use cases in high performance drive architectures related to permanent magnet synchronous and asynchronous machines. The implementation of this transform is as follows:</p>
<p><b>Park Transform:</b> </p><pre class="fragment">Isd = Ialpha*cos(theta) + Ibeta*sin(theta)
Isq = -Ialpha*sin(theta) + Ibeta*cos(theta)
</pre><p><b>Inverse Park Transform</b> </p><pre class="fragment">Ialpha = Isd*cos(theta) - Isq*sin(theta)
Ibeta = Isd*sin(theta) + Iq*cos(theta)
</pre><p>Ialpha = Stationary d-axis stator current</p>
<p>Ibeta = Stationary q-axis stator current</p>
<p>Isd = Rotating d-axis stator current</p>
<p>Isq = Rotating q-axis stator current</p>
<p>theta = Rotating angle in per unit</p>
<p><b>Park Transform:</b> </p><pre class="fragment">Isd = Ialpha*cos(theta) + Ibeta*sin(theta)
Isq = -Ialpha*sin(theta) + Ibeta*cos(theta)
</pre><p><b>Inverse Park Transform</b> </p><pre class="fragment">Ialpha = Isd*cos(theta) - Isq*sin(theta)
Ibeta = Isd*sin(theta) + Iq*cos(theta)
</pre><p>Ialpha = Stationary d-axis stator current</p>
<p>Ibeta = Stationary q-axis stator current</p>
<p>Isd = Rotating d-axis stator current</p>
<p>Isq = Rotating q-axis stator current</p>
<p>theta = Rotating angle in per unit</p>
<p>To implement this in an application-level, the Park and Inverse Park Transform computations are happening in an ISR context. We have configured an EPWM module which will trigger ADC SOC conversions for two ADC modules. The interrupt gets generated by the ADC Module 1 at end of conversion, an within ISR the park and inverse park calculations take place. These calculations makes use of TMU, TI ARM Trig Library and Mathlib library alternatively for trigonometric operations and computes the performance diiference between the three in terms of avgerage cycles taken, max cycles taken and min cycles taken.</p>
<p>From the results it is observed that using TMU improves performance by 84.5% in comparison to using Mathlib library, and there is a performance improvement of approximately 60% in comparison to using TI ARM Trig Library</p>
<h2><a class="anchor" id="autotoc_md2927"></a>
Interrupt Configurations</h2>
<ul>
<li>ADC1 INT 1 is generated at the EOC/SOC2</li>
</ul>
<h2><a class="anchor" id="autotoc_md2928"></a>
ISR</h2>
<ul>
<li>ADC INT 1 is configured to ISR, App_adcISR</li>
</ul>
<h1><a class="anchor" id="autotoc_md2929"></a>
External Connections</h1>
<ul>
<li>ADC2_AIN0, ADC2_AIN1, ADC2_AIN2 and ADC1_AIN0, ADC1_AIN1, ADC1_AIN2 pins should be connected to signals to be converted.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2930"></a>
AM263PX-CC E2</h2>
<p>When using AM263PX-CC E2 with TMDSHSECDOCK (HSEC180 controlCARD Baseboard Docking Station)</p><ul>
<li>Feed analog inputs to the following.<ul>
<li>ADC2_AIN0 - HSEC 31</li>
<li>ADC2_AIN1 - HSEC 33</li>
<li>ADC2_AIN2 - HSEC 37</li>
<li>ADC1_AIN0 - HSEC 12</li>
<li>ADC1_AIN1 - HSEC 14</li>
<li>ADC1_AIN2 - HSEC 18</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md2931"></a>
AM263PX-CC E1</h2>
<p>When using AM263PX-CC E1 with TMDSHSECDOCK (HSEC180 controlCARD Baseboard Docking Station)</p><ul>
<li>Feed analog inputs to the following.<ul>
<li>ADC2_AIN0 - HSEC 24</li>
<li>ADC2_AIN1 - HSEC 26</li>
<li>ADC2_AIN2 - HSEC 28</li>
<li>ADC1_AIN0 - HSEC 18</li>
<li>ADC1_AIN1 - HSEC 20</li>
<li>ADC1_AIN2 - HSEC 21</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md2932"></a>
AM263PX-LP</h2>
<p>When using LP</p><ul>
<li>Feed the analog inputs</li>
<li>Feed analog inputs to the following.<ul>
<li>ADC2_AIN0 - J1/J3 25</li>
<li>ADC2_AIN1 - J5/J7 63</li>
<li>ADC2_AIN2 - J5/J7 68</li>
<li>ADC1_AIN0 - J1/J3 24</li>
<li>ADC1_AIN1 - J1/J3 29</li>
<li>ADC1_AIN2 - J5/J7 67</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="EXAMPLES_DRIVERSTMU_PARK_TRANSFORM_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 nortos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am263px-cc, am263px-lp   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/tmu/tmu_park_transform/   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2933"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>)</li>
<li>Establish connections as mentioned in External Connections section</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
<li>View the console log for results</li>
</ul>
<h1><a class="anchor" id="autotoc_md2934"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is run,</p>
<div class="fragment"><div class="line">TMU Park Transform Test Started ...</div>
<div class="line">ADC Read Results :</div>
<div class="line">ADC 1 SOC0 result : 15, ADC1 SOC1 result : 85, ADC1 SOC2 result : 24</div>
<div class="line">ADC 2 SOC0 result : 48, ADC2 SOC1 result : 23, ADC2 SOC2 result : 21</div>
<div class="line">ADC 1 SOC0 result : 14, ADC1 SOC1 result : 59, ADC1 SOC2 result : 21</div>
<div class="line">ADC 2 SOC0 result : 12, ADC2 SOC1 result : 24, ADC2 SOC2 result : 19</div>
<div class="line">ADC 1 SOC0 result : 15, ADC1 SOC1 result : 59, ADC1 SOC2 result : 21</div>
<div class="line">ADC 2 SOC0 result : 11, ADC2 SOC1 result : 23, ADC2 SOC2 result : 19</div>
<div class="line">ADC 1 SOC0 result : 15, ADC1 SOC1 result : 59, ADC1 SOC2 result : 21</div>
<div class="line">ADC 2 SOC0 result : 12, ADC2 SOC1 result : 24, ADC2 SOC2 result : 20</div>
<div class="line">ADC 1 SOC0 result : 14, ADC1 SOC1 result : 59, ADC1 SOC2 result : 21</div>
<div class="line">ADC 2 SOC0 result : 11, ADC2 SOC1 result : 22, ADC2 SOC2 result : 21</div>
<div class="line">ADC 1 SOC0 result : 15, ADC1 SOC1 result : 58, ADC1 SOC2 result : 21</div>
<div class="line">ADC 2 SOC0 result : 11, ADC2 SOC1 result : 23, ADC2 SOC2 result : 21</div>
<div class="line">Park Transform Results :</div>
<div class="line">Avg cycles taken by TMU : 96.541176</div>
<div class="line">Avg cycles taken by TI ARM Trig Library : 243.711761</div>
<div class="line">Avg cycles taken by Clang Mathlib Library : 623.152954</div>
<div class="line">Max cycles taken by TMU : 188.000000</div>
<div class="line">Max cycles taken by TI ARM Trig Library : 364.000000</div>
<div class="line">Max cycles taken by Clang Mathlib Library : 878.000000</div>
<div class="line">Min cycles taken by TMU : 96.000000</div>
<div class="line">Min cycles taken by TI ARM Trig Library : 243.000000</div>
<div class="line">Min cycles taken by Clang Mathlib Library : 552.000000</div>
<div class="line">Inverse Park Transform Results :</div>
<div class="line">Avg cycles taken by TMU : 95.264709</div>
<div class="line">Avg cycles taken by TI ARM Trig Library : 239.329407</div>
<div class="line">Avg cycles taken by Clang Mathlib Library : 622.929382</div>
<div class="line">Max cycles taken by TMU : 140.000000</div>
<div class="line">Max cycles taken by TI ARM Trig Library : 295.000000</div>
<div class="line">Max cycles taken by Clang Mathlib Library : 689.000000</div>
<div class="line">Min cycles taken by TMU : 95.000000</div>
<div class="line">Min cycles taken by TI ARM Trig Library : 239.000000</div>
<div class="line">Min cycles taken by Clang Mathlib Library : 551.000000</div>
<div class="line"> </div>
<div class="line">TMU Park Transform Test Passed!!</div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2935"></a>
See Also</h1>
<ul>
<li><a class="el" href="MATHLIB_DRIVER.html#TMU_LIBRARY">TMU library</a></li>
<li><a class="el" href="TMU_GUIDE.html">Trigonometric Math Unit Guide</a></li>
<li><a class="el" href="group__DRV__TMU__MODULE.html">APIs for TMU</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
